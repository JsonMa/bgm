$(function(){var e={init:function(){this.bindEvent()},bindEvent:function(){var n=new SimpleMDE({element:document.getElementById("newsContent")});$(".upload-img").click(function(){var n=new IOT.Dialog({title:"新增企业形象",content:'<div class="row"><form class="col-md-offset-1 col-md-10"><div class="form-group"><label for="fileInput" class="control-label">上传图片：(宽、高比例为1.5:1，参考值为：700像素x469像素)</label><div class="control-label"><div id="zyupload" class="zyupload"></div>  </div></div></form></div>',showClose:!0,className:"",cache:!1,showOk:!1,okText:"确定",okCallback:function(){},showCancel:!0,cancelText:"确定",cancelCallback:function(){$(".response-url")[0]?n.close():IOT.tips("没有上传任何图片","warning",1e3)}});n.open(function(){e.imageUploader()})}),$(".btn-save").click(function(){var e=$(this),t=e.attr("mode"),i="create"==t?"/news/add":"/news/edit",l={newsContent:n.value(),newsTitle:$("#newsTitle").val(),newsSubtitle:$("#newsSubtitle").val(),newsType:$("#newsType option:selected").val(),newsAuthor:$("#newsAuthor").val(),newsOrigin:$("#newsOrigin").val(),newsTag:$("#newsTag").val()},s=e.attr("id");return s&&(l.id=s),l.newsTitle.length>30?void IOT.tips("新闻标题需要在30字内！","warning",1500):l.newsSubtitle.length>80?void IOT.tips("新闻摘要需要在80字内！","warning",1500):void(l.newsContent&&l.newsTitle&&l.newsSubtitle&&l.newsType&&l.newsAuthor&&l.newsOrigin&&l.newsTag?$.post(i,l,function(e){0==e.code?IOT.tips(e.msg,"success",1e3):IOT.tips(e.msg,"error",1e3)}):IOT.tips("所有内容均不能未空","warning",1e3))})},imageUploader:function(){$("#zyupload").zyUpload({width:"520px",height:"auto",itemWidth:"140px",itemHeight:"115px",url:"/upload/news",fileType:["jpg","png"],fileSize:512e5,multiple:!0,dragDrop:!1,tailor:!1,del:!0,finishDel:!1,onSuccess:function(e,n){var n=$.parseJSON(n);if(0==n.code){IOT.tips("图片上传成功","success",800);var t=n.imgPath[0].replace("public","");$("#uploadInf").append("<p class='response-url'>上传成功，文件地址是："+t+"</p>"),$(".response-img").html("图片地址："+t)}else IOT.tips("图片上传失败","error",800)},onFailure:function(e,n){IOT.tips("图片上传失败","error",800)}})},copyText:function(e){var n=document.body.createTextRange();n.moveToElementText(e),n.scrollIntoView(),n.select(),n.execCommand("Copy"),n.collapse(!1),alert("复制成功!")}};e.init()});