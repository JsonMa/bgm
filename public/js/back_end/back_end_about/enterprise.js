$(function(){var e={init:function(){this.bindEvent()},bindEvent:function(){$(".item-switch").off("click").on("click",function(){var e=$(this),i=e.attr("status");id=e.attr("id"),$.post("/enterprise/status",{id:id,status:i},function(e){0==e.code?(IOT.tips(e.msg,"success",800),setTimeout(function(){window.location.reload()},800)):IOT.tips(e.msg,"warning",800)})}),$(".add-enterprise").click(function(){var i=new IOT.Dialog({title:"新增企业形象",content:'<div class="row"><form class="col-md-offset-1 col-md-10"><div class="form-group"><label for="inputEmail3" class="control-label">形象名称：</label><input type="text" class="form-control" id="inputName" name="name" placeholder="请输企业风采名称" required><input type="hidden" class="form-control" id="imgUrl" name="imgUrl"></div><div class="form-group"><label for="inputPassword3" class="control-label">形象描述：</label><textarea id="imgDes" class="form-control" rows="3" name="des" placeholder="请输入企业风采描述"></textarea></div><div class="form-group"><label for="fileInput" class="control-label">上传图片：(宽、高比例为1.5:1，参考值为：700像素x469像素)</label><div class="control-label"><div id="zyupload" class="zyupload"></div>  </div></div></form></div>',beforeClose:function(){return!1},showClose:!0,className:"",cache:!1,showOk:!0,okText:"取消",okCallback:function(){},showCancel:!0,cancelText:"保存",cancelCallback:function(){var e={name:$("#inputName").val(),imgUrl:$("#imgUrl").val(),imgDes:$("#imgDes").val()};""!=e.imgUrl&&""!=e.name?$.post("/enterprise/add",e,function(e){0==e.code?(IOT.tips(e.msg,"success",800),setTimeout(function(){window.location.reload()},800)):IOT.tips(e.msg,"error",800)}):""==e.imgUrl?IOT.tips("图片地址不能为空，请上传图片！","warning","800"):IOT.tips("名称不能为空！","warning","800")}});i.open(function(){e.imageUploader()})}),$(".btn-delete").click(function(){var e=$(this),i=e.attr("id"),t=e.attr("imgUrl"),n="/enterprise/delete";IOT.Dialog.confirm("是否删除该条记录？",function(){$.post(n,{id:i,imgUrl:t},function(e){0==e.code?(IOT.tips(e.msg,"success",800),setTimeout(function(){window.location.reload()},800)):IOT.tips(e.msg,"warning",800)})},function(){return!1})}),$(".btn-detail").click(function(){var e=$(this),i=e.parent(),t=i.find(".honorName").html(),n=e.attr("imgUrl").replace("public",".."),o=new IOT.Dialog({title:"企业风采详情",content:'<div class="row" style="text-align: center"><h4>'+t+'</h4><img class="enterprise-img" src="'+n+'"/></div>',beforeClose:null,showClose:!0,className:"",cache:!1,showOk:!0,okText:"确定",okCallback:function(){},showCancel:!1,cancelText:"取消",cancelCallback:function(){o.close()}});o.open()})},imageUploader:function(){$("#zyupload").zyUpload({width:"520px",height:"auto",itemWidth:"140px",itemHeight:"115px",url:"/upload/about",fileType:["jpg","png"],fileSize:512e5,multiple:!0,dragDrop:!1,tailor:!1,del:!0,finishDel:!1,onSelect:function(e,i){},onDelete:function(e,i){},onSuccess:function(e,i){IOT.tips("图片上传成功","success",800);var t=$.parseJSON(i);$("#imgUrl").val(t.imgPath[0])},onFailure:function(e,i){},onComplete:function(e){}})}};e.init()});