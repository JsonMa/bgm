$(function(){var n={init:function(){this.bindEvent(),this.drawMap()},bindEvent:function(){window.Parsley.addValidator("user",{validateString:function(n){var e=/^([\u4E00-\uFA29]|[\uE7C7-\uE7F3]|[a-zA-Z0-9])*$/;return!!e.test(n)}}),window.Parsley.addValidator("phone",{validateString:function(n){var e=/^(((13[0-9]{1})|(15[0-9]{1})|(18[0-9]{1}))+\d{8})$/;return!!e.test(n)}}),window.Parsley.addValidator("email",{validateString:function(n){var e=/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;return!!e.test(n)}}),$("#contact_form").parsley().on("form:submit",function(){var n=$("#contact_form").serialize();return $.ajax({type:"GET",url:"/contact/add",data:n,dataType:"json",success:function(n){0==n.code?(IOT.tips("留言提交成功，我们将尽快与您取得联系！","success",1500),setTimeout(function(){window.location.reload()},1500)):IOT.tips(n.msg,"error",1e3)},error:function(n){console.log(n)}}),!1})},drawMap:function(){function n(){e(),t(),o(),i()}function e(){var n=new BMap.Map("dituContent"),e=new BMap.Point(106.466041,29.736451);n.centerAndZoom(e,16),window.map=n}function t(){map.enableDragging(),map.enableScrollWheelZoom(),map.enableDoubleClickZoom(),map.enableKeyboard()}function o(){var n=new BMap.OverviewMapControl({anchor:BMAP_ANCHOR_BOTTOM_RIGHT,isOpen:1});map.addControl(n);var e=new BMap.ScaleControl({anchor:BMAP_ANCHOR_BOTTOM_LEFT});map.addControl(e)}function i(){for(var n=0;n<c.length;n++){var e=c[n],t=e.point.split("|")[0],o=e.point.split("|")[1],i=new BMap.Point(t,o),l=r(e.icon),d=new BMap.Marker(i,{icon:l}),p=(a(n),new BMap.Label(e.title,{offset:new BMap.Size(e.icon.lb-e.icon.x+10,(-20))}));d.setLabel(p),map.addOverlay(d),p.setStyle({borderColor:"#808080",color:"#333",cursor:"pointer"}),function(){var t=a(n),o=d;o.addEventListener("click",function(){this.openInfoWindow(t)}),t.addEventListener("open",function(){o.getLabel().hide()}),t.addEventListener("close",function(){o.getLabel().show()}),p.addEventListener("click",function(){o.openInfoWindow(t)}),e.isOpen&&(p.hide(),o.openInfoWindow(t))}()}}function a(n){var e=c[n],t=new BMap.InfoWindow("<b class='iw_poi_title' title='"+e.title+"'>"+e.title+"</b><div class='iw_poi_content'>"+e.content+"</div>");return t}function r(n){var e=new BMap.Icon("http://app.baidu.com/map/images/us_mk_icon.png",new BMap.Size(n.w,n.h),{imageOffset:new BMap.Size((-n.l),(-n.t)),infoWindowOffset:new BMap.Size(n.lb+5,1),offset:new BMap.Size(n.x,n.h)});return e}var c=[{title:"重庆伊尔流体设备制造有限公司",content:"重庆伊尔流体设备制造有限公司",point:"106.461442|29.73395",isOpen:0,icon:{w:23,h:25,l:46,t:21,x:9,lb:12}}];n()}};n.init()});